# クレジットカード登録

**2016年12月のクレジットカードに関する法律（割賦販売法）改正によって、クレジットカードを取り扱う加盟店は、クレジットカード番号等の適切管理や不正利用等のセキュリティ対策を講じることが求められるようになりました。それに伴い、当該APIによるクレジットカード登録を非推奨とさせていただきます。**
**代わりに、クレジットカード登録（トークン決済方式）をご用意させていただきましたのでご参照ください。**

請求先登録更新後、レスポンスで返却された店舗オーダー番号をリクエストに加え、ROBOT PAYMENT決済システムにリクエスト送信することで、請求先の決済情報のクレジットカード情報を登録することができます。

## リクエスト
- Method URL: `https://credit-jpayment.co.jp/gateway/mktgate.aspx`
- Preferred HTTP method: `POST`
- Accepted content types: `application/x-www-form-urulencoded`
- Encode: `UTF-8`

### Parameters

| 名前 | 概要                                                                                                                                                                                                                  | 桁数     | 種別     | 必須                                         |
| ---- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------- | -------- | -------------------------------------------- |
| aid  | 店舗ID  <br> ※契約時に発行された決済システムの店舗ID                                                                                                                                                                  | 6        | 数値     | 必須                                         |
| jb   | ジョブタイプ <br> “CHECK”:カード有効性チェック                                                                                                                                                                        | 5        | 半角英数 |                                              |
| rt   | 決済結果返信方法 <br> 1:レスポンス                                                                                                                                                                                    | 1        | 数値     | 必須                                         |
| cod  | 店舗オーダー番号 <br> ※請求先登録更新時に返却された店舗オーダー番号を入力 <br> ※決済システム側で登録してあるクレジットカードの一意なキーとなります <br> ※初回登録時や、クレジットカード情報を更新する場合に指定します | 50       | 半角英数 |                                              |
| cn   | カード番号                                                                                                                                                                                                            | 16       | 数値     | 必須                                         |
| ed   | カード有効期限（YYMM形式）                                                                                                                                                                                            | 4        | 数値     | 必須                                         |
| fn   | カード名義（姓）                                                                                                                                                                                                      | 50       | 文字列   | 必須                                         |
| ln   | カード名義（名）                                                                                                                                                                                                      | 50       | 文字列   | 必須                                         |
| em   | メールアドレス                                                                                                                                                                                                        | 100      | 半角英数 | 必須                                         |
| pn   | 電話番号                                                                                                                                                                                                              | 20       | 数値     | 必須                                         |
| cvv  | セキュリティコード                                                                                                                                                                                                    | 3または4 | 数値     | (セキュリティコード利用オプションをご利用時) |

## レスポンス

- Type: `Comma-Separated`
- Encode: `UTF-8`

| 名前 | 概要                                                    |
| ---- | ------------------------------------------------------- |
| gid  | 決済番号 <br> ※決済ごとに発行されるユニークID           |
| rst  | 決済結果 <br> 1:決済成功 2:決済失敗                     |
| ap   | カード会社承認番号 <br> ※決済ごとに発行されるユニークID |
| ec   | エラーコード <br> ※詳細はエラーコード一覧               |
| god  | オーダーコード <br> ※決済ごとに発行されるユニークID     |
| cod  | 店舗オーダー番号 <br> ※送信された店舗オーダー番号       |
| am   | 決済金額 <br> ※null                                     |
| tx   | 税金額 <br> ※null                                       |
| sf   | 送料 <br> ※null                                         |
| ta   | 合計金額 <br> ※null                                     |
| id   | 発行ID <br> ※null                                       |
| ps   | 発行パスワード <br> ※null                               |


## 使用例

### リクエスト

```
aid: 1234567
rt: 1
cod: “7c3cb103256544999fed1d6b8f17ea20"
cn: 4444333322221111
ed:2209
fn:"yamada"
ln:"taro"
em:"yamada.taro@mail.com"
pn:"0312345678"
memo:"goods-code-01"
```

### レスポンス

Status: 200 OK

```
181418,1,0001112,,181357,7c3cb103256544999fed1d6b8f17ea20,0,0,0,0,,,memo=goods-code-01
```

## エラー

[決済システムエラーコード一覧](/public/j-payment/ec.md)
